<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blombly Companion - Return from New</title>
    <link rel="stylesheet" rel="prefetch" href="style.css">
    <link rel="stylesheet" rel="prefetch" href="prism.css">
</head>
<body>
<div class="sidebar">
    <h2>Blombly Companion</h2>
    <a rel="prefetch" href="index.html">Home</a>
    <a rel="prefetch" href="introduction.html">Introduction</a>
    <p><strong>Set things up</strong></p>
    <a rel="prefetch" href="hello-world.html">1.1 Hello world!</a>
    <a rel="prefetch" href="errors.html">1.2 Errors</a>
    <p><strong>Basic features</strong></p>
    <a rel="prefetch" href="vars-operations-comments.html">2.1 Vars, operations, comments</a>
    <a rel="prefetch" href="control-flow.html">2.2 Control flow</a>
    <a rel="prefetch" href="code-blocks-inline.html">2.3 Code blocks & inline</a>
    <a rel="prefetch" href="calling-blocks.html">2.4 Calling blocks</a>
    <a rel="prefetch" href="structs.html">2.5 Structs</a>
    <p><strong>Advanced features</strong></p>
    <a rel="prefetch" href="preprocessor.html">3.1 Preprocess (include, macro)</a>
    <a rel="prefetch" href="success-fail.html">3.2 Signals (try, return)</a>
    <a rel="prefetch" href="return-from-new.html" style="color: orange;">3.3 Return from new</a>
    <a rel="prefetch" href="overloading.html">3.4 Overloading</a>
</div>
<button class="toggle-button" onclick="toggleSidebar()">â˜°</button>
<h1>Return from new</h1>

<p>Return statements from within <code>new {...}</code> stop its execution and change the
obtained value. This can be used to replace block calls with a forced single-threaded
recursion that does not modify the parent context. For example:</p>

<pre><code class="language-java">final fib = {  // make it final so that it can see itself
    if(n&lt;2){return 1;} 
    return new{n = n-1;fib:} + new{n = n-2;fib:};
}

tic = time();
print("Result", fib(n=21));
print("Time", time()-tic);</code></pre>




<pre><code class="language-java">#include "std/oop"

final method = new {
    final message = "Declared in new scope";
    fn printer() {
        print(message);
    }
    return printer;
}
rebased_method = {method:}

final message = "Declared in external scope";
method();
rebased_method();
</code></pre>


<script src="prism.min.js"></script>
<script src="prism-java.min.js"></script>
<script>
    function toggleSidebar() {
        document.body.classList.toggle('show-sidebar');
    }
</script>
</body>
</html>
